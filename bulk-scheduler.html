<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MogulMomma Bulk Scheduler - Import & Schedule Multiple Posts</title>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="social-api-backend.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 800;
            background: linear-gradient(135deg, #ff8a65 0%, #ff7043 25%, #d81b60 75%, #8e24aa 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #6b7280;
        }

        .breadcrumb a {
            color: #ff8a65;
            text-decoration: none;
            font-weight: 600;
        }

        /* Main Container */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px;
        }

        .page-header {
            margin-bottom: 40px;
        }

        .page-title {
            font-size: 2.5rem;
            font-weight: 800;
            color: #1e293b;
            margin-bottom: 10px;
        }

        .page-subtitle {
            font-size: 1.2rem;
            color: #64748b;
            max-width: 600px;
        }

        /* Import Methods Grid */
        .import-methods {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .import-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .import-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
            border-color: #ff8a65;
        }

        .import-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .import-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #ff8a65, #d81b60);
            color: white;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .import-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e293b;
        }

        .import-description {
            color: #64748b;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .import-features {
            list-style: none;
            margin-bottom: 25px;
        }

        .import-features li {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
            color: #374151;
        }

        .import-features li::before {
            content: 'âœ“';
            background: #10b981;
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .import-action {
            width: 100%;
            background: linear-gradient(135deg, #ff8a65, #d81b60);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .import-action:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(255, 138, 101, 0.3);
        }

        /* CSV Upload Area */
        .csv-upload-area {
            border: 2px dashed #d1d5db;
            border-radius: 16px;
            padding: 60px 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 30px;
            background: white;
        }

        .csv-upload-area:hover {
            border-color: #ff8a65;
            background: rgba(255, 138, 101, 0.05);
        }

        .csv-upload-area.dragover {
            border-color: #ff8a65;
            background: rgba(255, 138, 101, 0.1);
        }

        .upload-icon {
            background: #f3f4f6;
            color: #6b7280;
            padding: 20px;
            border-radius: 50%;
            display: inline-flex;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .upload-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 10px;
        }

        .upload-subtitle {
            color: #64748b;
            margin-bottom: 20px;
        }

        .sample-download {
            background: #f8fafc;
            color: #ff8a65;
            border: 1px solid #e2e8f0;
            padding: 10px 20px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .sample-download:hover {
            background: #e2e8f0;
        }

        /* Preview Table */
        .preview-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
            display: none;
        }

        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .preview-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #1e293b;
        }

        .preview-count {
            background: #f3f4f6;
            color: #6b7280;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .preview-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 25px;
        }

        .preview-table th {
            background: #f8fafc;
            color: #374151;
            font-weight: 600;
            padding: 12px;
            text-align: left;
            border-bottom: 2px solid #e2e8f0;
        }

        .preview-table td {
            padding: 12px;
            border-bottom: 1px solid #e2e8f0;
            max-width: 200px;
            word-wrap: break-word;
        }

        .preview-table tr:hover {
            background: #f8fafc;
        }

        .platform-badges {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        .platform-badge {
            background: #e5e7eb;
            color: #374151;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .platform-badge.facebook { background: #1877f2; color: white; }
        .platform-badge.instagram { background: #e4405f; color: white; }
        .platform-badge.twitter { background: #1da1f2; color: white; }
        .platform-badge.linkedin { background: #0077b5; color: white; }

        .schedule-options {
            background: #f8fafc;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .schedule-title {
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 15px;
        }

        .schedule-methods {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .schedule-method {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .schedule-method:hover {
            border-color: #ff8a65;
        }

        .schedule-method.selected {
            border-color: #ff8a65;
            background: rgba(255, 138, 101, 0.1);
        }

        .method-title {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 5px;
        }

        .method-description {
            color: #64748b;
            font-size: 0.9rem;
        }

        .bulk-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
        }

        .btn-secondary {
            background: #f8fafc;
            color: #6b7280;
            border: 2px solid #e5e7eb;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ff8a65, #d81b60);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(255, 138, 101, 0.3);
        }

        /* Results Panel */
        .results-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            display: none;
        }

        .results-header {
            margin-bottom: 25px;
        }

        .results-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 10px;
        }

        .results-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .summary-card {
            background: #f8fafc;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .summary-number {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 5px;
        }

        .summary-number.success { color: #10b981; }
        .summary-number.error { color: #ef4444; }
        .summary-number.total { color: #6366f1; }

        .summary-label {
            color: #64748b;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .results-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .result-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            border-bottom: 1px solid #e2e8f0;
        }

        .result-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .result-icon.success { background: #10b981; }
        .result-icon.error { background: #ef4444; }

        .result-content {
            flex: 1;
        }

        .result-title {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 3px;
        }

        .result-message {
            color: #64748b;
            font-size: 0.9rem;
        }

        /* Template Builder */
        .template-builder {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
            display: none;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            color: #374151;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #ff8a65;
            box-shadow: 0 0 0 3px rgba(255, 138, 101, 0.1);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .main-container {
                padding: 20px;
            }

            .import-methods {
                grid-template-columns: 1fr;
            }

            .bulk-actions {
                justify-content: stretch;
                flex-direction: column;
            }

            .schedule-methods {
                grid-template-columns: 1fr;
            }

            .results-summary {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">ðŸ‘‘ MogulMomma Social</div>
            <div class="breadcrumb">
                <a href="/social-media-calendar.html">Calendar</a>
                <i data-lucide="chevron-right" style="width: 16px; height: 16px;"></i>
                <span>Bulk Scheduler</span>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Page Header -->
        <div class="page-header">
            <h1 class="page-title">Bulk Scheduler</h1>
            <p class="page-subtitle">Import and schedule multiple posts at once. Save hours of manual work with our powerful bulk scheduling tools.</p>
        </div>

        <!-- Import Methods -->
        <div class="import-methods">
            <div class="import-card">
                <div class="import-header">
                    <div class="import-icon">
                        <i data-lucide="file-spreadsheet"></i>
                    </div>
                    <h3 class="import-title">CSV Import</h3>
                </div>
                <p class="import-description">
                    Upload a CSV file with your content, schedule times, and platform selections. Perfect for bulk content planning.
                </p>
                <ul class="import-features">
                    <li>Support for unlimited posts</li>
                    <li>Custom scheduling per post</li>
                    <li>Platform-specific content</li>
                    <li>Media file references</li>
                </ul>
                <button class="import-action" onclick="showCSVImport()">
                    <i data-lucide="upload"></i>
                    Import CSV File
                </button>
            </div>

            <div class="import-card">
                <div class="import-header">
                    <div class="import-icon">
                        <i data-lucide="copy"></i>
                    </div>
                    <h3 class="import-title">Content Duplicator</h3>
                </div>
                <p class="import-description">
                    Take one piece of content and automatically adapt it for multiple platforms with AI-powered optimization.
                </p>
                <ul class="import-features">
                    <li>AI content adaptation</li>
                    <li>Platform-specific formatting</li>
                    <li>Hashtag optimization</li>
                    <li>Automatic scheduling spread</li>
                </ul>
                <button class="import-action" onclick="showContentDuplicator()">
                    <i data-lucide="copy"></i>
                    Duplicate Content
                </button>
            </div>

            <div class="import-card">
                <div class="import-header">
                    <div class="import-icon">
                        <i data-lucide="calendar-days"></i>
                    </div>
                    <h3 class="import-title">Template Scheduler</h3>
                </div>
                <p class="import-description">
                    Use pre-built content templates and automatically schedule them across multiple weeks or months.
                </p>
                <ul class="import-features">
                    <li>Weekly content themes</li>
                    <li>Seasonal campaigns</li>
                    <li>Recurring post series</li>
                    <li>Custom template builder</li>
                </ul>
                <button class="import-action" onclick="showTemplateScheduler()">
                    <i data-lucide="calendar-plus"></i>
                    Schedule Templates
                </button>
            </div>
        </div>

        <!-- CSV Upload Area -->
        <div class="csv-upload-area" id="csvUploadArea" onclick="document.getElementById('csvInput').click()">
            <div class="upload-icon">
                <i data-lucide="file-spreadsheet"></i>
            </div>
            <h3 class="upload-title">Drop your CSV file here</h3>
            <p class="upload-subtitle">or click to browse and select your file</p>
            <a href="#" class="sample-download" onclick="downloadSampleCSV()">
                <i data-lucide="download" style="width: 16px; height: 16px;"></i>
                Download Sample CSV
            </a>
            <input type="file" id="csvInput" accept=".csv" style="display: none;">
        </div>

        <!-- Preview Container -->
        <div class="preview-container" id="previewContainer">
            <div class="preview-header">
                <h3 class="preview-title">Content Preview</h3>
                <span class="preview-count" id="previewCount">0 posts</span>
            </div>

            <div class="schedule-options">
                <h4 class="schedule-title">Scheduling Options</h4>
                <div class="schedule-methods">
                    <div class="schedule-method selected" onclick="selectScheduleMethod(this, 'as-specified')">
                        <div class="method-title">As Specified</div>
                        <div class="method-description">Use dates/times from CSV</div>
                    </div>
                    <div class="schedule-method" onclick="selectScheduleMethod(this, 'spread-week')">
                        <div class="method-title">Spread Over Week</div>
                        <div class="method-description">Evenly distribute posts</div>
                    </div>
                    <div class="schedule-method" onclick="selectScheduleMethod(this, 'optimal-times')">
                        <div class="method-title">Optimal Times</div>
                        <div class="method-description">AI-suggested posting times</div>
                    </div>
                    <div class="schedule-method" onclick="selectScheduleMethod(this, 'custom-pattern')">
                        <div class="method-title">Custom Pattern</div>
                        <div class="method-description">Define your own schedule</div>
                    </div>
                </div>
            </div>

            <div style="max-height: 300px; overflow-y: auto; margin-bottom: 25px;">
                <table class="preview-table" id="previewTable">
                    <thead>
                        <tr>
                            <th>Content</th>
                            <th>Platforms</th>
                            <th>Scheduled Time</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="previewTableBody">
                        <!-- Preview rows will be populated here -->
                    </tbody>
                </table>
            </div>

            <div class="bulk-actions">
                <button class="btn-secondary" onclick="hidePreview()">
                    <i data-lucide="x"></i>
                    Cancel
                </button>
                <button class="btn-primary" onclick="processBulkScheduling()">
                    <i data-lucide="calendar-check"></i>
                    Schedule All Posts
                </button>
            </div>
        </div>

        <!-- Template Builder -->
        <div class="template-builder" id="templateBuilder">
            <div class="preview-header">
                <h3 class="preview-title">Template Builder</h3>
            </div>

            <div class="form-group">
                <label class="form-label">Template Name</label>
                <input type="text" class="form-input" id="templateName" placeholder="e.g., Weekly Motivation Series">
            </div>

            <div class="form-group">
                <label class="form-label">Content Template</label>
                <textarea class="form-input form-textarea" id="templateContent" placeholder="Use {{variable}} for dynamic content..."></textarea>
            </div>

            <div class="form-group">
                <label class="form-label">Repeat Pattern</label>
                <select class="form-input" id="repeatPattern">
                    <option value="weekly">Weekly</option>
                    <option value="biweekly">Bi-weekly</option>
                    <option value="monthly">Monthly</option>
                    <option value="custom">Custom</option>
                </select>
            </div>

            <div class="bulk-actions">
                <button class="btn-secondary" onclick="hideTemplateBuilder()">Cancel</button>
                <button class="btn-primary" onclick="createTemplateSchedule()">
                    <i data-lucide="save"></i>
                    Create & Schedule
                </button>
            </div>
        </div>

        <!-- Results Container -->
        <div class="results-container" id="resultsContainer">
            <div class="results-header">
                <h3 class="results-title">Scheduling Results</h3>
            </div>

            <div class="results-summary" id="resultsSummary">
                <div class="summary-card">
                    <div class="summary-number total" id="totalPosts">0</div>
                    <div class="summary-label">Total Posts</div>
                </div>
                <div class="summary-card">
                    <div class="summary-number success" id="successfulPosts">0</div>
                    <div class="summary-label">Scheduled</div>
                </div>
                <div class="summary-card">
                    <div class="summary-number error" id="failedPosts">0</div>
                    <div class="summary-label">Failed</div>
                </div>
            </div>

            <div class="results-list" id="resultsList">
                <!-- Results will be populated here -->
            </div>

            <div class="bulk-actions" style="margin-top: 25px;">
                <button class="btn-primary" onclick="returnToCalendar()">
                    <i data-lucide="calendar"></i>
                    View Calendar
                </button>
            </div>
        </div>
    </div>

    <script>
        // Initialize the social media manager
        const socialManager = new SocialMediaManager();
        let csvData = [];
        let selectedScheduleMethod = 'as-specified';

        // CSV Import Functions
        function showCSVImport() {
            document.getElementById('csvUploadArea').style.display = 'block';
            hideOtherSections();
        }

        function showContentDuplicator() {
            alert('Content Duplicator coming soon! This feature will use AI to adapt your content for different platforms.');
        }

        function showTemplateScheduler() {
            document.getElementById('templateBuilder').style.display = 'block';
            hideOtherSections();
        }

        function hideOtherSections() {
            document.getElementById('previewContainer').style.display = 'none';
            document.getElementById('resultsContainer').style.display = 'none';
        }

        function hidePreview() {
            document.getElementById('previewContainer').style.display = 'none';
            document.getElementById('csvUploadArea').style.display = 'block';
        }

        function hideTemplateBuilder() {
            document.getElementById('templateBuilder').style.display = 'none';
        }

        // File Upload Handling
        document.getElementById('csvInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file && file.type === 'text/csv') {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const csvContent = e.target.result;
                    processCSV(csvContent);
                };
                reader.readAsText(file);
            } else {
                alert('Please select a valid CSV file.');
            }
        });

        // Drag and Drop
        const uploadArea = document.getElementById('csvUploadArea');
        
        uploadArea.addEventListener('dragover', function(e) {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', function(e) {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', function(e) {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            
            const files = e.dataTransfer.files;
            if (files.length > 0 && files[0].type === 'text/csv') {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const csvContent = e.target.result;
                    processCSV(csvContent);
                };
                reader.readAsText(files[0]);
            } else {
                alert('Please drop a valid CSV file.');
            }
        });

        // CSV Processing
        function processCSV(csvContent) {
            try {
                csvData = parseCSV(csvContent);
                showPreview();
            } catch (error) {
                alert('Error processing CSV: ' + error.message);
            }
        }

        function parseCSV(csvContent) {
            const lines = csvContent.split('\n');
            const headers = lines[0].split(',').map(h => h.trim().toLowerCase());
            const posts = [];

            for (let i = 1; i < lines.length; i++) {
                if (lines[i].trim()) {
                    const values = lines[i].split(',');
                    const post = {};
                    
                    headers.forEach((header, index) => {
                        post[header] = values[index]?.trim() || '';
                    });

                    // Validate required fields
                    if (post.content && post.platforms) {
                        // Parse platforms
                        post.platforms = post.platforms.split(';').map(p => p.trim().toLowerCase());
                        
                        // Parse scheduled time
                        if (post.date && post.time) {
                            post.scheduledTime = new Date(post.date + ' ' + post.time);
                        } else {
                            post.scheduledTime = new Date(); // Default to now
                        }

                        post.status = 'ready';
                        posts.push(post);
                    }
                }
            }

            return posts;
        }

        function showPreview() {
            document.getElementById('csvUploadArea').style.display = 'none';
            document.getElementById('previewContainer').style.display = 'block';
            
            updatePreviewTable();
            document.getElementById('previewCount').textContent = `${csvData.length} posts`;
        }

        function updatePreviewTable() {
            const tbody = document.getElementById('previewTableBody');
            tbody.innerHTML = '';

            csvData.forEach((post, index) => {
                const row = document.createElement('tr');
                
                const platformBadges = post.platforms.map(platform => 
                    `<span class="platform-badge ${platform}">${platform}</span>`
                ).join('');

                row.innerHTML = `
                    <td title="${post.content}">${post.content.substring(0, 50)}${post.content.length > 50 ? '...' : ''}</td>
                    <td><div class="platform-badges">${platformBadges}</div></td>
                    <td>${post.scheduledTime.toLocaleString()}</td>
                    <td><span class="platform-badge" style="background: #10b981; color: white;">${post.status}</span></td>
                `;
                
                tbody.appendChild(row);
            });
        }

        function selectScheduleMethod(element, method) {
            document.querySelectorAll('.schedule-method').forEach(el => el.classList.remove('selected'));
            element.classList.add('selected');
            selectedScheduleMethod = method;

            // Update scheduled times based on method
            updateScheduleTimes();
        }

        function updateScheduleTimes() {
            const now = new Date();
            
            switch (selectedScheduleMethod) {
                case 'spread-week':
                    const interval = (7 * 24 * 60 * 60 * 1000) / csvData.length; // Week in milliseconds / number of posts
                    csvData.forEach((post, index) => {
                        post.scheduledTime = new Date(now.getTime() + (interval * index));
                    });
                    break;
                    
                case 'optimal-times':
                    // Simulate optimal times (9am, 1pm, 5pm weekdays)
                    const optimalHours = [9, 13, 17];
                    csvData.forEach((post, index) => {
                        const dayOffset = Math.floor(index / optimalHours.length);
                        const hour = optimalHours[index % optimalHours.length];
                        const scheduleDate = new Date(now);
                        scheduleDate.setDate(scheduleDate.getDate() + dayOffset);
                        scheduleDate.setHours(hour, 0, 0, 0);
                        post.scheduledTime = scheduleDate;
                    });
                    break;
                    
                case 'custom-pattern':
                    // Would open a custom pattern builder
                    alert('Custom pattern builder coming soon!');
                    break;
                    
                // 'as-specified' keeps original times
            }
            
            updatePreviewTable();
        }

        async function processBulkScheduling() {
            document.getElementById('previewContainer').style.display = 'none';
            document.getElementById('resultsContainer').style.display = 'block';

            let successful = 0;
            let failed = 0;
            const resultsList = document.getElementById('resultsList');
            resultsList.innerHTML = '';

            for (let i = 0; i < csvData.length; i++) {
                const post = csvData[i];
                
                try {
                    const result = await socialManager.schedulePost({
                        content: post.content,
                        platforms: post.platforms,
                        scheduledTime: post.scheduledTime,
                        media: post.media ? post.media.split(';') : [],
                        hashtags: post.hashtags ? post.hashtags.split(' ') : []
                    });

                    if (result.success) {
                        successful++;
                        addResultItem('success', post.content, 'Scheduled successfully');
                    } else {
                        failed++;
                        addResultItem('error', post.content, result.message || 'Scheduling failed');
                    }
                } catch (error) {
                    failed++;
                    addResultItem('error', post.content, error.message);
                }

                // Update progress
                updateResultsSummary(csvData.length, successful, failed);
                
                // Small delay to show progress
                await new Promise(resolve => setTimeout(resolve, 100));
            }
        }

        function addResultItem(type, content, message) {
            const resultsList = document.getElementById('resultsList');
            const item = document.createElement('div');
            item.className = 'result-item';
            
            item.innerHTML = `
                <div class="result-icon ${type}">
                    <i data-lucide="${type === 'success' ? 'check' : 'x'}" style="width: 20px; height: 20px;"></i>
                </div>
                <div class="result-content">
                    <div class="result-title">${content.substring(0, 60)}${content.length > 60 ? '...' : ''}</div>
                    <div class="result-message">${message}</div>
                </div>
            `;
            
            resultsList.appendChild(item);
            
            // Re-initialize Lucide icons for new content
            lucide.createIcons();
        }

        function updateResultsSummary(total, successful, failed) {
            document.getElementById('totalPosts').textContent = total;
            document.getElementById('successfulPosts').textContent = successful;
            document.getElementById('failedPosts').textContent = failed;
        }

        // Template Functions
        function createTemplateSchedule() {
            const name = document.getElementById('templateName').value;
            const content = document.getElementById('templateContent').value;
            const pattern = document.getElementById('repeatPattern').value;

            if (!name || !content) {
                alert('Please fill in template name and content.');
                return;
            }

            // Create multiple posts based on pattern
            const posts = generateTemplateSchedule(content, pattern);
            csvData = posts;
            
            hideTemplateBuilder();
            showPreview();
        }

        function generateTemplateSchedule(content, pattern) {
            const posts = [];
            const now = new Date();
            let interval;

            switch (pattern) {
                case 'weekly':
                    interval = 7 * 24 * 60 * 60 * 1000; // 1 week
                    break;
                case 'biweekly':
                    interval = 14 * 24 * 60 * 60 * 1000; // 2 weeks
                    break;
                case 'monthly':
                    interval = 30 * 24 * 60 * 60 * 1000; // ~1 month
                    break;
                default:
                    interval = 7 * 24 * 60 * 60 * 1000;
            }

            // Generate 12 posts (3 months worth)
            for (let i = 0; i < 12; i++) {
                const scheduledTime = new Date(now.getTime() + (interval * i));
                posts.push({
                    content: content.replace('{{week}}', i + 1).replace('{{date}}', scheduledTime.toLocaleDateString()),
                    platforms: ['facebook', 'instagram', 'linkedin'],
                    scheduledTime: scheduledTime,
                    status: 'ready'
                });
            }

            return posts;
        }

        // Sample CSV Download
        function downloadSampleCSV() {
            const sampleData = `content,platforms,date,time,hashtags,media
"Monday Motivation: Your dreams don't expire! âœ¨","facebook;instagram;twitter","2024-12-20","09:00","#MondayMotivation #DreamBig",""
"Tuesday Tip: Network authentically ðŸ’¼","linkedin;twitter","2024-12-21","14:30","#TuesdayTip #Networking",""
"Behind the scenes at MogulMomma ðŸ‘‘","instagram;facebook","2024-12-22","11:00","#BehindTheScenes","image1.jpg"
"Friday Feature: Amazing entrepreneurs ðŸš€","facebook;linkedin;instagram","2024-12-23","10:00","#FeatureFriday #WomenInBusiness","image2.jpg"`;

            const blob = new Blob([sampleData], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'mogulmomma-sample-posts.csv';
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
        }

        function returnToCalendar() {
            window.location.href = '/social-media-calendar.html';
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            lucide.createIcons();
        });
    </script>
</body>
</html>